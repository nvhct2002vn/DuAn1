CREATE DATABASE QLBHDIENMAY_TSOFTWEAR
GO

USE QLBHDIENMAY_TSOFTWEAR
GO

CREATE TABLE NHOMHANHOA
(
MaNHH VARCHAR(10),
TenNHH NVARCHAR(50),
GhiChu NVARCHAR(200),
PRIMARY KEY (MaNHH)
)
GO

CREATE TABLE NHANVIEN
(
MaNV VARCHAR(10),
TenNV NVARCHAR(50),
DiaChi NVARCHAR(50),
DienThoai VARCHAR(12),
GioiTinh BIT,
NgaySinh DATE,
PRIMARY KEY (MaNV) 
)
GO

CREATE TABLE SANPHAM
(
MaSP VARCHAR(10),
MaNHH VARCHAR(10),
TeNSP NVARCHAR(50),
NhomPhoBien BIT,
NhaSX NVARCHAR(50),
NuocSX NVARCHAR(50),
SoLuong INT,
GiaNhap MONEY,
GiaBan MONEY,
MoTa NVARCHAR(100),
PRIMARY KEY (MaSP),
FOREIGN KEY (MaNHH) REFERENCES NHOMHANHOA (MANHH),
)
GO

CREATE TABLE TAIKHOAN
(
MaNV VARCHAR(10),
MatKhau VARCHAR(100),
VaiTro BIT,
PRIMARY KEY(MaNV),
FOREIGN KEY (MaNV) REFERENCES NHANVIEN (MaNV)
)
GO

CREATE TABLE KHACHHANG
(
MaKH VARCHAR(10),
TenKH NVARCHAR(50),
DIENTHOAI VARCHAR(12),
EMAIL VARCHAR(50),
DIACHI NVARCHAR(50),
PRIMARY KEY (MaKH)
)
GO

CREATE TABLE HOADON
(
MaHD VARCHAR(10),
MaNV VARCHAR(10),
MaKH VARCHAR(10),
NgayLap DATE,
TrangThaiTT NVARCHAR(30),
HinhThucTT NVARCHAR(30),
TongTien MONEY,
GhiChu NVARCHAR(100),
PRIMARY KEY (MaHD),
FOREIGN KEY (MaNV) REFERENCES NHANVIEN (MaNV),
FOREIGN KEY (MaKH) REFERENCES KHACHHANG(MaKH),
)
GO

CREATE TABLE HOADONDOITRA(
MaHDDT VARCHAR(10),
MaHD VARCHAR(10),
MaNV VARCHAR(10),
DonGia MONEY,
NgayLap DATE,
MoTa NVARCHAR(100),
PRIMARY KEY (MaHDDT),
FOREIGN KEY (MaHD) REFERENCES HOADON (MaHD),
FOREIGN KEY (MaNV) REFERENCES NHANVIEN (MaNV)
) 
GO

CREATE TABLE HOADONCHITIET
(
MaHD VARCHAR(10),
MaSP VARCHAR(10),
SoLuong INT,
DonGia MONEY,
GiamGia MONEY,
ThanhTien MONEY,
PRIMARY KEY (MaHD , MaSP ) ,
FOREIGN KEY (MaHD) REFERENCES HOADON (MaHD),
FOREIGN KEY (MaSP) REFERENCES SANPHAM (MaSP)
)
GO

CREATE TABLE VOUCHER 
(
MaVOUCHER VARCHAR(10),
MaNHH VARCHAR(10),
NgayTao DATE DEFAULT GETDATE(),
NgayHetHan DATE,
SoLuong INT,
MenhGia MONEY,
TrangThai BIT,
GhiChu NVARCHAR(100),
PRIMARY KEY (MaVOUCHER),
FOREIGN KEY (MaNHH) REFERENCES NHOMHANHOA (MaNHH)
)
GO

CREATE TABLE KHUYENMAI
(
MaKM VARCHAR(10),
MaNHH VARCHAR(10),
TenCT NVARCHAR(50),
HinhThuc NVARCHAR(100),
BatDau DATE,
KetThuc DATE,
GiamGia FLOAT,
MoTa NVARCHAR(100),
PRIMARY KEY (MaKM),
FOREIGN KEY(MaNHH) REFERENCES NHOMHANHOA (MaNHH)
)
GO


INSERT INTO NHOMHANHOA VALUES('NH001',N'Tivi,Loa,Dàn Karaoke','Ghichu1'),
							 ('NH002',N'Tủ lạnh, Tủ đông, Tủ mát','Ghichu2'),
							 ('NH003',N'Máy giặt, Sấy quần áo','Ghichu3'),
							 ('NH004',N'Máy lạnh, Quạt điều hòa','Ghichu4'),
							 ('NH005',N'Điện gia dụng, Dụng cụ','Ghichu5')

INSERT INTO NHANVIEN VALUES('NV001',N'Đỗ Tất Hòa','TH','0123456789',1,'01-01-2002'),
						   ('NV002',N'Thiều Quang Vinh','TH','0123456789',0,'02-01-2002'),
						   ('NV003',N'Lê Thành Vinh','TH','0123456789',1,'03-01-2002'),
						   ('NV004',N'Nguyễn Viết Hiên','TH','0123456789',1,'04-01-2002'),
						   ('NV005',N'Nguyễn Hồng Sơn','TH','0123456789',0,'05-01-2002')

INSERT INTO TAIKHOAN VALUES('NV001','123',1),
						   ('NV002','123',1),
						   ('NV003','123',1),
						   ('NV004','123',0),
						   ('NV005','123',0)  

INSERT INTO SANPHAM VALUES('SP001','NH001',N'Loa Bluetooth Mozard E7',0,N'SX1','xxx',9,'1000','1000','mota1'),
						  ('SP002','NH001',N'Loa vi tính Bluetooth',0,N'SX1','xxx',10,'1000','1000','mota1'),
						  ('SP003','NH002',N'Tủ lạnh Samsung Inverter 236 lít',0,N'SX1','xxx',11,'2000','1000','mota1'),
						  ('SP004','NH003',N'Aqua Inverter 8.5 Kg',1,N'SX1','xxx',8,'1500','1000','mota1'),
						  ('SP005','NH004',N'Kangaroo KG50F62',0,N'SX1','xxx',5,'3000','1000','mota1'),
						  ('SP006','NH004',N'Gree KSWK-0603D',1,N'SX1','xxx',0,'3500','1000','mota1'),
						  ('SP007','NH005',N'Nồi chiên không dầu Kalite Q5',0,N'SX1','xxx',3,'1000','1000','mota1'),
						  ('SP008','NH005',N'Máy xay đa năng Kangaroo KG2B3',1,N'SX1','xxx',2,'1000','1000','mota1'),
						  ('SP009','NH002',N'Samsung Inverter 647 lít',0,N'SX1','xxx',1,'6000','1000','mota1')

INSERT INTO KHACHHANG VALUES('KH001',N'NGUYỄN A','0123456789','A2@GMAIL.COM','HN'),
							('KH002',N'NGUYỄN B','0123456789','B2@GMAIL.COM','HN'),
							('KH003',N'NGUYỄN C','0123456789','C2@GMAIL.COM','HN'),
							('KH004',N'NGUYỄN D','0123456789','D2@GMAIL.COM','HN'),
							('KH005',N'NGUYỄN E','0123456789','E2@GMAIL.COM','HN')

INSERT INTO HOADON VALUES('HD001','NV001','KH001','01-01-2021',N'ĐÃ THANH TOÁN','TIỀN MẶT',3000,'NOT'),
						 ('HD002','NV001','KH001','02-01-2021',N'ĐÃ THANH TOÁN','TIỀN MẶT',3000,'NOT'),
						 ('HD003','NV003','KH002','03-01-2021',N'ĐÃ THANH TOÁN','TIỀN MẶT',3000,'NOT'),
						 ('HD004','NV004','KH003','04-01-2021',N'ĐÃ THANH TOÁN','TIỀN MẶT',3000,'NOT'),
						 ('HD005','NV005','KH004','05-01-2021',N'ĐÃ THANH TOÁN','TIỀN MẶT',3000,'NOT'),
						 ('HD006','NV002','KH005','06-01-2021',N'ĐÃ THANH TOÁN','TIỀN MẶT',3000,'NOT'),
						 ('HD007','NV002','KH005','07-01-2021',N'ĐÃ THANH TOÁN','TIỀN MẶT',3000,'NOT')

INSERT INTO HOADONDOITRA VALUES('DT001','HD001','NV001',3000,'02-01-2021','NOT'),
						       ('DT002','HD002','NV002',3000,'03-01-2021','NOT'),
							   ('DT003','HD003','NV003',3000,'04-01-2021','NOT'),
							   ('DT004','HD004','NV003',3000,'05-01-2021','NOT'),
							   ('DT005','HD005','NV005',3000,'06-01-2021','NOT'),
							   ('DT006','HD006','NV005',3000,'07-01-2021','NOT')

INSERT INTO HOADONCHITIET VALUES('HD001','SP001',1,6000,2000,4000),
								('HD002','SP002',2,6000,2000,4000),
								('HD003','SP003',2,6000,2000,4000),
								('HD004','SP004',1,6000,2000,4000),
								('HD005','SP005',1,6000,2000,4000),
								('HD006','SP006',2,6000,2000,4000),
								('HD007','SP007',1,6000,2000,4000)

INSERT INTO KHUYENMAI VALUES('KM001','NH001',N'SINH NHẬT HÒA','ONLINE','2021-09-21','2021-09-22',0.5,'NOT'),
							('KM002','NH003',N'SINH NHẬT HÒA','ONLINE','2021-09-21','2021-09-22',0.5,'NOT'),
							('KM003','NH004',N'SINH NHẬT HÒA','OFLLINE','2021-09-21','2021-09-22',0.5,'NOT'),
							('KM004','NH005',N'SINH NHẬT HÒA','ONLINE','2021-09-21','2021-09-22',0.5,'NOT')

INSERT INTO VOUCHER VALUES('VC001','NH001','09-09-2021','10-09-2021',100,1000,1,'NOT')


SELECT MaSP,TeNSP, TenNHH, MaVOUCHER, MenhGia, NgayHetHan
FROM NHOMHANHOA JOIN VOUCHER ON NHOMHANHOA.MaNHH = VOUCHER.MaNHH
			    JOIN KHUYENMAI ON KHUYENMAI.MaNHH = NHOMHANHOA.MaNHH
				JOIN SANPHAM ON SANPHAM.MaNHH = NHOMHANHOA.MaNHH
				JOIN HOADONCHITIET ON HOADONCHITIET.MaSP = SANPHAM.MaSP
				JOIN HOADON ON HOADON.MaHD = HOADONCHITIET.MaHD
				JOIN  
				 
